-- LAB4

CREATE TABLE SUPPLIER(
SNO int AUTO_INCREMENT,
    SNAME varchar(250),
    CITY VARCHAR(250),
    PRIMARY KEY(SNO)
);

CREATE TABLE PART(
PNO int auto_increment,
    PNAME VARCHAR(250),
    PRICE int,
    PRIMARY KEY(PNO)
);

CREATE TABLE SELLS(
SNO int,
    PNO int
);

INSERT INTO SUPPLIER (SNAME, CITY) VALUES
('Smith', 'London'),
('John', 'Paris'),
('Alice', 'Vienna'),
('Bob', 'Berlin');

INSERT INTO PART (PNAME, PRICE) VALUES
('Nut', 10),
('Bolt', 20),
('Screw', 15),
('Washer', 5);

INSERT INTO SELLS(SNO,PNO) VALUES (1,1);
INSERT INTO SELLS(SNO,PNO) VALUES (1,2);
INSERT INTO SELLS(SNO,PNO) VALUES (2,4);
INSERT INTO SELLS(SNO,PNO) VALUES (3,1);
INSERT INTO SELLS(SNO,PNO) VALUES (3,3);
INSERT INTO SELLS(SNO,PNO) VALUES (4,2);
INSERT INTO SELLS(SNO,PNO) VALUES (4,3);
INSERT INTO SELLS(SNO,PNO) VALUES (4,4);


SELECT * FROM PART,SELLS,SUPPLIER;

SELECT * FROM PART,SUPPLIER,SELLS
WHERE PART.PNO=SELLS.PNO  AND SELLS.SNO=SUPPLIER.SNO AND SUPPLIER.SNAME="Smith";

SELECT MAX(PRICE) FROM PART;

SELECT SUPPLIER.SNAME,COUNT(*) AS COUNTOF FROM SUPPLIER,PART,SELLS
WHERE SUPPLIER.SNO=SELLS.SNO AND SELLS.PNO=PART.PNO
GROUP BY SUPPLIER.SNAME
ORDER BY COUNTOF DESC
LIMIT 1;

SELECT SUPPLIER.SNAME FROM SUPPLIER,PART,SELLS
WHERE SUPPLIER.SNO=SELLS.SNO AND SELLS.PNO=PART.PNO AND PART.PNAME="Nut";

SELECT PART.PNAME FROM PART,SUPPLIER,SELLS
WHERE PART.PNO=SELLS.PNO AND SELLS.SNO=SUPPLIER.SNO AND SUPPLIER.CITY="Vienna";
